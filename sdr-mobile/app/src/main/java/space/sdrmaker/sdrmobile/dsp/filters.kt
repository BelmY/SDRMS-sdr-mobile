package space.sdrmaker.sdrmobile.dsp

import kotlin.math.ceil
import kotlin.math.floor

val NOAA_TAPS = floatArrayOf(
    -7.383784e-03f,
    -3.183046e-03f, 2.255039e-03f, 7.461166e-03f, 1.091908e-02f,
    1.149109e-02f, 8.769802e-03f, 3.252932e-03f, -3.720606e-03f,
    -1.027446e-02f, -1.447403e-02f, -1.486427e-02f, -1.092423e-02f,
    -3.307958e-03f, 6.212477e-03f, 1.511364e-02f, 2.072873e-02f,
    2.096037e-02f, 1.492345e-02f, 3.347624e-03f, -1.138407e-02f,
    -2.560252e-02f, -3.507114e-02f, -3.591225e-02f, -2.553830e-02f,
    -3.371569e-03f, 2.882645e-02f, 6.711368e-02f, 1.060042e-01f,
    1.394643e-01f, 1.620650e-01f, 1.700462e-01f, 1.620650e-01f,
    1.394643e-01f, 1.060042e-01f, 6.711368e-02f, 2.882645e-02f,
    -3.371569e-03f, -2.553830e-02f, -3.591225e-02f, -3.507114e-02f,
    -2.560252e-02f, -1.138407e-02f, 3.347624e-03f, 1.492345e-02f,
    2.096037e-02f, 2.072873e-02f, 1.511364e-02f, 6.212477e-03f,
    -3.307958e-03f, -1.092423e-02f, -1.486427e-02f, -1.447403e-02f,
    -1.027446e-02f, -3.720606e-03f, 3.252932e-03f, 8.769802e-03f,
    1.149109e-02f, 1.091908e-02f, 7.461166e-03f, 2.255039e-03f,
    -3.183046e-03f, -7.383784e-03f
)

val FM_TAPS = floatArrayOf(
    0.04569721334034695f,
    -0.0014984279723340673f,
    0.11503570009461829f,
    -0.10199147438866914f,
    0.2008203889520777f,
    -0.3258053682622002f,
    0.44703675904735474f,
    -0.6630057483154398f,
    0.9487460954814383f,
    -1.2845363633197984f,
    1.7465931430974069f,
    -2.3411039573838255f,
    3.0510179136086815f,
    -3.9442181405341294f,
    5.051015302163319f,
    -6.356317517103702f,
    7.920049984543817f,
    -9.791839751011734f,
    11.957929834381758f,
    -14.46549679808007f,
    17.377101419515782f,
    -20.67894757431064f,
    24.397659439879813f,
    -28.600253940135733f,
    33.27073294311891f,
    -38.40633471755184f,
    44.06839736787468f,
    -50.236469774059174f,
    56.87104242036442f,
    -64.01644485597906f,
    71.64755432912143f,
    -79.68363099230835f,
    88.14142908472839f,
    -96.99429889882619f,
    106.12008345947294f,
    -115.5005827849022f,
    125.1133916142939f,
    -134.80259220473252f,
    144.50893315607334f,
    -154.22535078380292f,
    163.7762584615264f,
    -173.0573851377706f,
    182.09135675666698f,
    -190.7054475823649f,
    198.74360100815912f,
    -206.27570685927355f,
    213.16556359748f,
    -219.1847023081026f,
    224.4707616905682f,
    -228.98862775485046f,
    232.35830435878492f,
    -234.79499459394734f,
    236.7263281942179f,
    -236.5752462675513f,
    236.7263281942179f,
    -234.79499459394734f,
    232.35830435878492f,
    -228.98862775485046f,
    224.4707616905682f,
    -219.1847023081026f,
    213.16556359748f,
    -206.27570685927355f,
    198.74360100815912f,
    -190.7054475823649f,
    182.09135675666698f,
    -173.0573851377706f,
    163.7762584615264f,
    -154.22535078380292f,
    144.50893315607334f,
    -134.80259220473252f,
    125.1133916142939f,
    -115.5005827849022f,
    106.12008345947294f,
    -96.99429889882619f,
    88.14142908472839f,
    -79.68363099230835f,
    71.64755432912143f,
    -64.01644485597906f,
    56.87104242036442f,
    -50.236469774059174f,
    44.06839736787468f,
    -38.40633471755184f,
    33.27073294311891f,
    -28.600253940135733f,
    24.397659439879813f,
    -20.67894757431064f,
    17.377101419515782f,
    -14.46549679808007f,
    11.957929834381758f,
    -9.791839751011734f,
    7.920049984543817f,
    -6.356317517103702f,
    5.051015302163319f,
    -3.9442181405341294f,
    3.0510179136086815f,
    -2.3411039573838255f,
    1.7465931430974069f,
    -1.2845363633197984f,
    0.9487460954814383f,
    -0.6630057483154398f,
    0.44703675904735474f,
    -0.3258053682622002f,
    0.2008203889520777f,
    -0.10199147438866914f,
    0.11503570009461829f,
    -0.0014984279723340673f,
    0.04569721334034695f
)

val FM_TAPS_2 = floatArrayOf(
    -0.0009174668230116367f,
    0.0004714197129942477f,
    0.0018038529669865966f,
    0.0012254401808604598f,
    -0.0019195646746084094f,
    -0.004480223637074232f,
    -0.0015121476026251912f,
    0.006301297340542078f,
    0.009455546736717224f,
    -0.00038574900827370584f,
    -0.01580973155796528f,
    -0.016016853973269463f,
    0.008181950077414513f,
    0.03377588465809822f,
    0.022670598700642586f,
    -0.030368395149707794f,
    -0.07171222567558289f,
    -0.027632232755422592f,
    0.11805921047925949f,
    0.2874653935432434f,
    0.36268800497055054f,
    0.2874653935432434f,
    0.11805921047925949f,
    -0.027632232755422592f,
    -0.07171222567558289f,
    -0.030368395149707794f,
    0.022670598700642586f,
    0.03377588465809822f,
    0.008181950077414513f,
    -0.016016853973269463f,
    -0.01580973155796528f,
    -0.00038574900827370584f,
    0.009455546736717224f,
    0.006301297340542078f,
    -0.0015121476026251912f,
    -0.004480223637074232f,
    -0.0019195646746084094f,
    0.0012254401808604598f,
    0.0018038529669865966f,
    0.0004714197129942477f,
    -0.0009174668230116367f
)

val AUDIO_TAPS = floatArrayOf(
    -2.1026537455615113e-10f,
    -4.456930582819041e-06f,
    -2.4047219540079823e-06f,
    5.243866326054558e-05f,
    -0.00015256620827130973f,
    0.00025941358762793243f,
    -0.0002803144452627748f,
    0.00011062905832659453f,
    0.00030021709972061217f,
    -0.0008810955914668739f,
    0.0014093166682869196f,
    -0.001553630456328392f,
    0.0010001695482060313f,
    0.00036914978409186006f,
    -0.0023170425556600094f,
    0.004201103467494249f,
    -0.005105476826429367f,
    0.0041625783778727055f,
    -0.0009831939823925495f,
    -0.003969075623899698f,
    0.0092548169195652f,
    -0.012733039446175098f,
    0.012245085090398788f,
    -0.006540898699313402f,
    -0.0038774218410253525f,
    0.016380062326788902f,
    -0.026598434895277023f,
    0.029639381915330887f,
    -0.02186792530119419f,
    0.002715057460591197f,
    0.02416585385799408f,
    -0.050968851894140244f,
    0.06726731359958649f,
    -0.0627593845129013f,
    0.030509423464536667f,
    0.030310358852148056f,
    -0.11313558369874954f,
    0.20476587116718292f,
    -0.28813526034355164f,
    0.3464210629463196f,
    1.6326535940170288f,
    0.3464210629463196f,
    -0.28813526034355164f,
    0.20476587116718292f,
    -0.11313559114933014f,
    0.030310360714793205f,
    0.030509425327181816f,
    -0.06275937706232071f,
    0.06726729869842529f,
    -0.050968851894140244f,
    0.02416585385799408f,
    0.0027150569949299097f,
    -0.021867923438549042f,
    0.029639391228556633f,
    -0.026598434895277023f,
    0.0163800660520792f,
    -0.00387742230668664f,
    -0.006540900096297264f,
    0.012245086021721363f,
    -0.012733039446175098f,
    0.009254815988242626f,
    -0.003969075623899698f,
    -0.0009831939823925495f,
    0.004162577912211418f,
    -0.005105475429445505f,
    0.004201102070510387f,
    -0.0023170418571680784f,
    0.0003691494930535555f,
    0.0010001701302826405f,
    -0.0015536310384050012f,
    0.0014093174831941724f,
    -0.0008810957660898566f,
    0.00030021724523976445f,
    0.00011062901467084885f,
    -0.0002803144452627748f,
    0.0002594131219666451f,
    -0.00015256620827130973f,
    5.243866326054558e-05f,
    -2.4047219540079823e-06f,
    -4.4566918404598255e-06f,
    -2.1026537455615113e-10f
)

val FM_882k_BLACKMAN = floatArrayOf(
    4.2740247452321967e-10f,
    8.672424155520275e-05f,
    0.0005919919349253178f,
    -0.0005498044192790985f,
    -0.0034673246555030346f,
    0.00023002238594926894f,
    0.010889561846852303f,
    0.0044597722589969635f,
    -0.02489580400288105f,
    -0.02103954367339611f,
    0.04522930458188057f,
    0.06329358369112015f,
    -0.06790119409561157f,
    -0.16649243235588074f,
    0.08602391183376312f,
    0.6199969053268433f,
    0.9070885181427002f,
    0.6199969053268433f,
    0.08602391928434372f,
    -0.16649241745471954f,
    -0.06790119409561157f,
    0.06329360604286194f,
    0.045229312032461166f,
    -0.02103954367339611f,
    -0.02489580027759075f,
    0.004459771793335676f,
    0.010889558121562004f,
    0.00023002250236459076f,
    -0.003467326518148184f,
    -0.0005498043028637767f,
    0.0005919908871874213f,
    8.672387048136443e-05f,
    4.2740247452321967e-10f
)

val FM_75k = floatArrayOf(
    -0.0007829090463928878f,
    -0.0006371058989316225f,
    -0.0002971103531308472f,
    0.00023241450253408402f,
    0.0008895984501577914f,
    0.0015184819931164384f,
    0.0018711105221882463f,
    0.0016696539241820574f,
    0.0007226078887470067f,
    -0.0009422985021956265f,
    -0.0029876071494072676f,
    -0.004776878748089075f,
    -0.005518388003110886f,
    -0.004525317344814539f,
    -0.0015225096140056849f,
    0.0031082213390618563f,
    0.008256535977125168f,
    0.01226037461310625f,
    0.013332201167941093f,
    0.010146976448595524f,
    0.0024295304901897907f,
    -0.00865316390991211f,
    -0.020461278036236763f,
    -0.029292242601513863f,
    -0.031185461208224297f,
    -0.022947778925299644f,
    -0.003136438550427556f,
    0.027282707393169403f,
    0.06482051312923431f,
    0.10397854447364807f,
    0.1383085995912552f,
    0.16177959740161896f,
    0.17011761665344238f,
    0.16177959740161896f,
    0.1383085995912552f,
    0.10397854447364807f,
    0.06482051312923431f,
    0.027282707393169403f,
    -0.003136438550427556f,
    -0.022947778925299644f,
    -0.031185461208224297f,
    -0.029292242601513863f,
    -0.020461278036236763f,
    -0.00865316390991211f,
    0.0024295304901897907f,
    0.010146976448595524f,
    0.013332201167941093f,
    0.01226037461310625f,
    0.008256535977125168f,
    0.0031082213390618563f,
    -0.0015225096140056849f,
    -0.004525317344814539f,
    -0.005518388003110886f,
    -0.004776878748089075f,
    -0.0029876071494072676f,
    -0.0009422985021956265f
)

val FM_20k = floatArrayOf(
    -0.00029723913758061826f,
    -0.0003781761624850333f,
    -0.0004573423939291388f,
    -0.0005345575045794249f,
    -0.0006092620315030217f,
    -0.0006804387085139751f,
    -0.00074655597563833f,
    -0.0008055425132624805f,
    -0.0008547923644073308f,
    -0.0008912058547139168f,
    -0.0009112656116485596f,
    -0.0009111479157581925f,
    -0.0008868671720847487f,
    -0.0008344498346559703f,
    -0.0007501328946091235f,
    -0.0006305802380666137f,
    -0.00047311026719398797f,
    -0.00027592439437285066f,
    -3.832968286587857e-05f,
    0.0002390559675404802f,
    0.0005541249993257225f,
    0.0009031370282173157f,
    0.0012806202284991741f,
    0.0016793254762887955f,
    0.002090238966047764f,
    0.002502660034224391f,
    0.002904343418776989f,
    0.003281715326011181f,
    0.0036201481707394123f,
    0.0039043088909238577f,
    0.00411855848506093f,
    0.004247404634952545f,
    0.004275995772331953f,
    0.004190641921013594f,
    0.003979349974542856f,
    0.003632362000644207f,
    0.003142675617709756f,
    0.0025065343361347914f,
    0.0017238652799278498f,
    0.0007986593409441411f,
    -0.0002607335045468062f,
    -0.0014413987519219518f,
    -0.0027257578913122416f,
    -0.004091581795364618f,
    -0.005512126721441746f,
    -0.006956391502171755f,
    -0.008389506489038467f,
    -0.009773237630724907f,
    -0.011066611856222153f,
    -0.012226649560034275f,
    -0.013209191150963306f,
    -0.013969803228974342f,
    -0.01446474064141512f,
    -0.014651951380074024f,
    -0.014492107555270195f,
    -0.013949603773653507f,
    -0.012993558309972286f,
    -0.011598731391131878f,
    -0.009746366180479527f,
    -0.007424941286444664f,
    -0.004630782641470432f,
    -0.001368532539345324f,
    0.0023485329002141953f,
    0.00649836752563715f,
    0.011050197295844555f,
    0.015964750200510025f,
    0.021194666624069214f,
    0.026685113087296486f,
    0.03237452730536461f,
    0.03819558396935463f,
    0.04407624527812004f,
    0.04994099214673042f,
    0.05571208521723747f,
    0.06131097674369812f,
    0.06665972620248795f,
    0.0716823935508728f,
    0.07630650699138641f,
    0.08046441525220871f,
    0.08409455418586731f,
    0.08714266866445541f,
    0.08956283330917358f,
    0.09131835401058197f,
    0.0923825055360794f,
    0.092739038169384f,
    0.0923825055360794f,
    0.09131835401058197f,
    0.08956283330917358f,
    0.08714266866445541f,
    0.08409455418586731f,
    0.08046441525220871f,
    0.07630650699138641f,
    0.0716823935508728f,
    0.06665972620248795f,
    0.06131097674369812f,
    0.05571208521723747f,
    0.04994099214673042f,
    0.04407624527812004f,
    0.03819558396935463f,
    0.03237452730536461f,
    0.026685113087296486f,
    0.021194666624069214f,
    0.015964750200510025f,
    0.011050197295844555f,
    0.00649836752563715f,
    0.0023485329002141953f,
    -0.001368532539345324f,
    -0.004630782641470432f,
    -0.007424941286444664f,
    -0.009746366180479527f,
    -0.011598731391131878f,
    -0.012993558309972286f,
    -0.013949603773653507f,
    -0.014492107555270195f,
    -0.014651951380074024f,
    -0.01446474064141512f,
    -0.013969803228974342f,
    -0.013209191150963306f,
    -0.012226649560034275f,
    -0.011066611856222153f,
    -0.009773237630724907f,
    -0.008389506489038467f,
    -0.006956391502171755f,
    -0.005512126721441746f,
    -0.004091581795364618f,
    -0.0027257578913122416f,
    -0.0014413987519219518f,
    -0.0002607335045468062f,
    0.0007986593409441411f,
    0.0017238652799278498f,
    0.0025065343361347914f,
    0.003142675617709756f,
    0.003632362000644207f,
    0.003979349974542856f,
    0.004190641921013594f,
    0.004275995772331953f,
    0.004247404634952545f,
    0.00411855848506093f,
    0.0039043088909238577f,
    0.0036201481707394123f,
    0.003281715326011181f,
    0.002904343418776989f,
    0.002502660034224391f,
    0.002090238966047764f,
    0.0016793254762887955f,
    0.0012806202284991741f,
    0.0009031370282173157f,
    0.0005541249993257225f,
    0.0002390559675404802f,
    -3.832968286587857e-05f,
    -0.00027592439437285066f,
    -0.00047311026719398797f,
    -0.0006305802380666137f,
    -0.0007501328946091235f,
    -0.0008344498346559703f,
    -0.0008868671720847487f,
    -0.0009111479157581925f,
    -0.0009112656116485596f,
    -0.0008912058547139168f,
    -0.0008547923644073308f,
    -0.0008055425132624805f,
    -0.00074655597563833f,
    -0.0006804387085139751f,
    -0.0006092620315030217f,
    -0.0005345575045794249f,
    -0.0004573423939291388f,
    -0.0003781761624850333f,
    -0.00029723913758061826f
)

val FM_80k = floatArrayOf(
    -0.0009002716396935284f,
    -0.0009684558608569205f,
    -0.0007392422994598746f,
    -0.00024358082737307996f,
    0.0004130659799557179f,
    0.0010559546062722802f,
    0.0014699781313538551f,
    0.0014564641751348972f,
    0.0009086097124963999f,
    -0.00011872040340676904f,
    -0.0013776678824797273f,
    -0.0024626152589917183f,
    -0.002920046914368868f,
    -0.0024108397774398327f,
    -0.0008734567672945559f,
    0.0013784428592771292f,
    0.0036808496806770563f,
    0.005187708418816328f,
    0.005150651093572378f,
    0.00322620733641088f,
    -0.00030291060102172196f,
    -0.004496441688388586f,
    -0.007967007346451283f,
    -0.009301821701228619f,
    -0.007578881923109293f,
    -0.0028030930552631617f,
    0.003914505243301392f,
    0.010547899641096592f,
    0.014714960008859634f,
    0.014466669410467148f,
    0.009062804281711578f,
    -0.0005456905928440392f,
    -0.011748661287128925f,
    -0.020898086950182915f,
    -0.024399403482675552f,
    -0.019971759989857674f,
    -0.007671728730201721f,
    0.009706002660095692f,
    0.027085792273283005f,
    0.03841046616435051f,
    0.03848972171545029f,
    0.02488674595952034f,
    -0.0007474412559531629f,
    -0.03238452598452568f,
    -0.06060431897640228f,
    -0.07472466677427292f,
    -0.06558974087238312f,
    -0.028289712965488434f,
    0.03596044331789017f,
    0.11937762051820755f,
    0.20883533358573914f,
    0.2885403633117676f,
    0.3435359597206116f,
    0.3631551265716553f,
    0.3435359597206116f,
    0.2885403633117676f,
    0.20883533358573914f,
    0.11937762051820755f,
    0.03596044331789017f,
    -0.028289712965488434f,
    -0.06558974087238312f,
    -0.07472466677427292f,
    -0.06060431897640228f,
    -0.03238452598452568f,
    -0.0007474412559531629f,
    0.02488674595952034f,
    0.03848972171545029f,
    0.03841046616435051f,
    0.027085792273283005f,
    0.009706002660095692f,
    -0.007671728730201721f,
    -0.019971759989857674f,
    -0.024399403482675552f,
    -0.020898086950182915f,
    -0.011748661287128925f,
    -0.0005456905928440392f,
    0.009062804281711578f,
    0.014466669410467148f,
    0.014714960008859634f,
    0.010547899641096592f,
    0.003914505243301392f,
    -0.0028030930552631617f,
    -0.007578881923109293f,
    -0.009301821701228619f,
    -0.007967007346451283f,
    -0.004496441688388586f,
    -0.00030291060102172196f,
    0.00322620733641088f,
    0.005150651093572378f,
    0.005187708418816328f,
    0.0036808496806770563f,
    0.0013784428592771292f,
    -0.0008734567672945559f,
    -0.0024108397774398327f,
    -0.002920046914368868f,
    -0.0024626152589917183f,
    -0.0013776678824797273f,
    -0.00011872040340676904f,
    0.0009086097124963999f,
    0.0014564641751348972f,
    0.0014699781313538551f,
    0.0010559546062722802f,
    0.0004130659799557179f,
    -0.00024358082737307996f,
    -0.0007392422994598746f,
    -0.0009684558608569205f,
    -0.0009002716396935284f
)

val CUT22k_FREQ441000 = floatArrayOf(
    -0.0002869263698812574f,
    -0.00019666166917886585f,
    -8.565064490539953e-05f,
    3.672826278489083e-05f,
    0.00015983832417987287f,
    0.00027253798907622695f,
    0.00036402017576619983f,
    0.00042469624895602465f,
    0.00044707051711156964f,
    0.0004265397437848151f,
    0.00036204364732839167f,
    0.0002564883616287261f,
    0.00011687083315337077f,
    -4.595380596583709e-05f,
    -0.00021789329184684902f,
    -0.0003826258471235633f,
    -0.000522949849255383f,
    -0.0006223872187547386f,
    -0.0006669110734947026f,
    -0.0006466322229243815f,
    -0.0005572634981945157f,
    -0.00040117467870004475f,
    -0.00018787384033203125f,
    6.62076854496263e-05f,
    0.00033868965692818165f,
    0.0006029601790942252f,
    0.0008305358933284879f,
    0.000993881723843515f,
    0.0010694342199712992f,
    0.0010405182838439941f,
    0.0008998297271318734f,
    0.0006511642714031041f,
    0.0003101254114881158f,
    -9.637074981583282e-05f,
    -0.0005318608600646257f,
    -0.0009533031843602657f,
    -0.0013150445884093642f,
    -0.0015734477201476693f,
    -0.001691738492809236f,
    -0.0016445678193122149f,
    -0.001421762048266828f,
    -0.0010307872435078025f,
    -0.0004975392948836088f,
    0.00013477203901857138f,
    0.0008086900925263762f,
    0.0014573700027540326f,
    0.002010857220739126f,
    0.002403231104835868f,
    0.002579920692369342f,
    0.002504416974261403f,
    0.002163622295483947f,
    0.001571149448864162f,
    0.0007680531707592309f,
    -0.00017928141460288316f,
    -0.001184095861390233f,
    -0.002146755810827017f,
    -0.002964185317978263f,
    -0.003540394362062216f,
    -0.0037970582488924265f,
    -0.003683050163090229f,
    -0.0031818316783756018f,
    -0.0023157773539423943f,
    -0.0011467456351965666f,
    0.0002274281723657623f,
    0.0016804480692371726f,
    0.0030685795936733484f,
    0.004244279582053423f,
    0.005071193445473909f,
    0.005439057946205139f,
    0.005276948679238558f,
    0.0045633926056325436f,
    0.003332076594233513f,
    0.0016722531290724874f,
    -0.00027653828146867454f,
    -0.0023353006690740585f,
    -0.004301200155168772f,
    -0.005966702476143837f,
    -0.007140498608350754f,
    -0.007668185979127884f,
    -0.007450586650520563f,
    -0.00645766407251358f,
    -0.004736335016787052f,
    -0.0024109813384711742f,
    0.00032388337422162294f,
    0.003218543017283082f,
    0.005989616736769676f,
    0.008346444927155972f,
    0.0100199980661273f,
    0.01079154945909977f,
    0.010518234223127365f,
    0.009152735583484173f,
    0.006754717789590359f,
    0.003492359770461917f,
    -0.00036683239159174263f,
    -0.0044757407158613205f,
    -0.008436608128249645f,
    -0.011837047524750233f,
    -0.014290007762610912f,
    -0.015474065206944942f,
    -0.015170126222074032f,
    -0.013290748000144958f,
    -0.009898744523525238f,
    -0.005212557967752218f,
    0.00040299815009348094f,
    0.006460756994783878f,
    0.012388702481985092f,
    0.017578352242708206f,
    0.02144027128815651f,
    0.023462047800421715f,
    0.0232635959982872f,
    0.020644595846533775f,
    0.015619280748069286f,
    0.008434673771262169f,
    -0.0004303702153265476f,
    -0.010286404751241207f,
    -0.020274262875318527f,
    -0.0294231865555048f,
    -0.03672220930457115f,
    -0.041199468076229095f,
    -0.04200326278805733f,
    -0.03847814351320267f,
    -0.030229628086090088f,
    -0.017171697691082954f,
    0.0004474268644116819f,
    0.02204418182373047f,
    0.04672417417168617f,
    0.07333125174045563f,
    0.10051798820495605f,
    0.12683260440826416f,
    0.1508161574602127f,
    0.17110252380371094f,
    0.18651355803012848f,
    0.19614210724830627f,
    0.19941669702529907f,
    0.19614210724830627f,
    0.18651355803012848f,
    0.17110252380371094f,
    0.1508161574602127f,
    0.12683260440826416f,
    0.10051798820495605f,
    0.07333125174045563f,
    0.04672417417168617f,
    0.02204418182373047f,
    0.0004474268644116819f,
    -0.017171697691082954f,
    -0.030229628086090088f,
    -0.03847814351320267f,
    -0.04200326278805733f,
    -0.041199468076229095f,
    -0.03672220930457115f,
    -0.0294231865555048f,
    -0.020274262875318527f,
    -0.010286404751241207f,
    -0.0004303702153265476f,
    0.008434673771262169f,
    0.015619280748069286f,
    0.020644595846533775f,
    0.0232635959982872f,
    0.023462047800421715f,
    0.02144027128815651f,
    0.017578352242708206f,
    0.012388702481985092f,
    0.006460756994783878f,
    0.00040299815009348094f,
    -0.005212557967752218f,
    -0.009898744523525238f,
    -0.013290748000144958f,
    -0.015170126222074032f,
    -0.015474065206944942f,
    -0.014290007762610912f,
    -0.011837047524750233f,
    -0.008436608128249645f,
    -0.0044757407158613205f,
    -0.00036683239159174263f,
    0.003492359770461917f,
    0.006754717789590359f,
    0.009152735583484173f,
    0.010518234223127365f,
    0.01079154945909977f,
    0.0100199980661273f,
    0.008346444927155972f,
    0.005989616736769676f,
    0.003218543017283082f,
    0.00032388337422162294f,
    -0.0024109813384711742f,
    -0.004736335016787052f,
    -0.00645766407251358f,
    -0.007450586650520563f,
    -0.007668185979127884f,
    -0.007140498608350754f,
    -0.005966702476143837f,
    -0.004301200155168772f,
    -0.0023353006690740585f,
    -0.00027653828146867454f,
    0.0016722531290724874f,
    0.003332076594233513f,
    0.0045633926056325436f,
    0.005276948679238558f,
    0.005439057946205139f,
    0.005071193445473909f,
    0.004244279582053423f,
    0.0030685795936733484f,
    0.0016804480692371726f,
    0.0002274281723657623f,
    -0.0011467456351965666f,
    -0.0023157773539423943f,
    -0.0031818316783756018f,
    -0.003683050163090229f,
    -0.0037970582488924265f,
    -0.003540394362062216f,
    -0.002964185317978263f,
    -0.002146755810827017f,
    -0.001184095861390233f,
    -0.00017928141460288316f,
    0.0007680531707592309f,
    0.001571149448864162f,
    0.002163622295483947f,
    0.002504416974261403f,
    0.002579920692369342f,
    0.002403231104835868f,
    0.002010857220739126f,
    0.0014573700027540326f,
    0.0008086900925263762f,
    0.00013477203901857138f,
    -0.0004975392948836088f,
    -0.0010307872435078025f,
    -0.001421762048266828f,
    -0.0016445678193122149f,
    -0.001691738492809236f,
    -0.0015734477201476693f,
    -0.0013150445884093642f,
    -0.0009533031843602657f,
    -0.0005318608600646257f,
    -9.637074981583282e-05f,
    0.0003101254114881158f,
    0.0006511642714031041f,
    0.0008998297271318734f,
    0.0010405182838439941f,
    0.0010694342199712992f,
    0.000993881723843515f,
    0.0008305358933284879f,
    0.0006029601790942252f,
    0.00033868965692818165f,
    6.62076854496263e-05f,
    -0.00018787384033203125f,
    -0.00040117467870004475f,
    -0.0005572634981945157f,
    -0.0006466322229243815f,
    -0.0006669110734947026f,
    -0.0006223872187547386f,
    -0.000522949849255383f,
    -0.0003826258471235633f,
    -0.00021789329184684902f,
    -4.595380596583709e-05f,
    0.00011687083315337077f,
    0.0002564883616287261f,
    0.00036204364732839167f,
    0.0004265397437848151f,
    0.00044707051711156964f,
    0.00042469624895602465f,
    0.00036402017576619983f,
    0.00027253798907622695f,
    0.00015983832417987287f,
    3.672826278489083e-05f,
    -8.565064490539953e-05f,
    -0.00019666166917886585f,
    -0.0002869263698812574f
)

val CUT80k_FREQ882000 = floatArrayOf(
    -0.000916934572160244f,
    -0.00030928116757422686f,
    0.00047114622429944575f,
    0.001253044349141419f,
    0.0018028065096586943f,
    0.0018599247559905052f,
    0.0012247292324900627f,
    -0.00012171053094789386f,
    -0.001918451045639813f,
    -0.003612187225371599f,
    -0.00447762431576848f,
    -0.003865898586809635f,
    -0.0015112704131752253f,
    0.0022242884151637554f,
    0.006297641899436712f,
    0.009203379973769188f,
    0.009450062178075314f,
    0.006165246479213238f,
    -0.000385525228921324f,
    -0.008597413077950478f,
    -0.015800559893250465f,
    -0.019015299156308174f,
    -0.01600756123661995f,
    -0.006310533732175827f,
    0.008177204057574272f,
    0.02332758530974388f,
    0.03375628963112831f,
    0.03445695713162422f,
    0.022657446563243866f,
    -0.0006909463554620743f,
    -0.030350778251886368f,
    -0.05749969184398651f,
    -0.07167062163352966f,
    -0.06350855529308319f,
    -0.02761620283126831f,
    0.035345401614904404f,
    0.11799072474241257f,
    0.2073001265525818f,
    0.28729861974716187f,
    0.34268561005592346f,
    0.3624776005744934f,
    0.34268561005592346f,
    0.28729861974716187f,
    0.2073001265525818f,
    0.11799072474241257f,
    0.035345401614904404f,
    -0.02761620283126831f,
    -0.06350855529308319f,
    -0.07167062163352966f,
    -0.05749969184398651f,
    -0.030350778251886368f,
    -0.0006909463554620743f,
    0.022657446563243866f,
    0.03445695713162422f,
    0.03375628963112831f,
    0.02332758530974388f,
    0.008177204057574272f,
    -0.006310533732175827f,
    -0.01600756123661995f,
    -0.019015299156308174f,
    -0.015800559893250465f,
    -0.008597413077950478f,
    -0.000385525228921324f,
    0.006165246479213238f,
    0.009450062178075314f,
    0.009203379973769188f,
    0.006297641899436712f,
    0.0022242884151637554f,
    -0.0015112704131752253f,
    -0.003865898586809635f,
    -0.00447762431576848f,
    -0.003612187225371599f,
    -0.001918451045639813f,
    -0.00012171053094789386f,
    0.0012247292324900627f,
    0.0018599247559905052f,
    0.0018028065096586943f,
    0.001253044349141419f,
    0.00047114622429944575f,
    -0.00030928116757422686f,
    -0.000916934572160244f
)

val CUT200k_FREQ882000 = floatArrayOf(
    0.0005444629350677133f,
    -0.0011064655845984817f,
    -0.0009614223963581026f,
    0.0010170122841373086f,
    0.001550842891447246f,
    -0.0008129327325150371f,
    -0.002360108308494091f,
    0.00030418808455578983f,
    0.003338043810799718f,
    0.0007196580991148949f,
    -0.004310672637075186f,
    -0.002433853456750512f,
    0.0049792444333434105f,
    0.0049171228893101215f,
    -0.004943896550685167f,
    -0.008094936609268188f,
    0.0037518355529755354f,
    0.011697402223944664f,
    -0.0009643901721574366f,
    -0.015239301137626171f,
    -0.003766599576920271f,
    0.01802513189613819f,
    0.010625039227306843f,
    -0.019175123423337936f,
    -0.01957201026380062f,
    0.01765848882496357f,
    0.03031338006258011f,
    -0.012304460629820824f,
    -0.04230105131864548f,
    0.0017293215496465564f,
    0.05477050691843033f,
    0.015971090644598007f,
    -0.0668116956949234f,
    -0.044224876910448074f,
    0.0774649977684021f,
    0.09157636761665344f,
    -0.0858297348022461f,
    -0.1897956281900406f,
    0.09117056429386139f,
    0.629193902015686f,
    0.9073811173439026f,
    0.629193902015686f,
    0.09117056429386139f,
    -0.1897956281900406f,
    -0.0858297348022461f,
    0.09157636761665344f,
    0.0774649977684021f,
    -0.044224876910448074f,
    -0.0668116956949234f,
    0.015971090644598007f,
    0.05477050691843033f,
    0.0017293215496465564f,
    -0.04230105131864548f,
    -0.012304460629820824f,
    0.03031338006258011f,
    0.01765848882496357f,
    -0.01957201026380062f,
    -0.019175123423337936f,
    0.010625039227306843f,
    0.01802513189613819f,
    -0.003766599576920271f,
    -0.015239301137626171f,
    -0.0009643901721574366f,
    0.011697402223944664f,
    0.0037518355529755354f,
    -0.008094936609268188f,
    -0.004943896550685167f,
    0.0049171228893101215f,
    0.0049792444333434105f,
    -0.002433853456750512f,
    -0.004310672637075186f,
    0.0007196580991148949f,
    0.003338043810799718f,
    0.00030418808455578983f,
    -0.002360108308494091f,
    -0.0008129327325150371f,
    0.001550842891447246f,
    0.0010170122841373086f,
    -0.0009614223963581026f,
    -0.0011064655845984817f,
    0.0005444629350677133f
)

val CUT75k_FREQ882000 = floatArrayOf(
    -0.0015658180927857757f,
    -0.001274211797863245f,
    -0.0005942207062616944f,
    0.00046482900506816804f,
    0.0017791969003155828f,
    0.0030369639862328768f,
    0.0037422210443764925f,
    0.0033393078483641148f,
    0.0014452157774940133f,
    -0.001884597004391253f,
    -0.005975214298814535f,
    -0.00955375749617815f,
    -0.011036776006221771f,
    -0.009050634689629078f,
    -0.0030450192280113697f,
    0.0062164426781237125f,
    0.016513071954250336f,
    0.0245207492262125f,
    0.026664402335882187f,
    0.020293952897191048f,
    0.0048590609803795815f,
    -0.01730632781982422f,
    -0.040922556072473526f,
    -0.058584485203027725f,
    -0.06237092241644859f,
    -0.04589555785059929f,
    -0.006272877100855112f,
    0.054565414786338806f,
    0.12964102625846863f,
    0.20795708894729614f,
    0.2766171991825104f,
    0.3235591948032379f,
    0.34023523330688477f,
    0.3235591948032379f,
    0.2766171991825104f,
    0.20795708894729614f,
    0.12964102625846863f,
    0.054565414786338806f,
    -0.006272877100855112f,
    -0.04589555785059929f,
    -0.06237092241644859f,
    -0.058584485203027725f,
    -0.040922556072473526f,
    -0.01730632781982422f,
    0.0048590609803795815f,
    0.020293952897191048f,
    0.026664402335882187f,
    0.0245207492262125f,
    0.016513071954250336f,
    0.0062164426781237125f,
    -0.0030450192280113697f,
    -0.009050634689629078f,
    -0.011036776006221771f,
    -0.00955375749617815f,
    -0.005975214298814535f,
    -0.001884597004391253f,
    0.0014452157774940133f,
    0.0033393078483641148f,
    0.0037422210443764925f,
    0.0030369639862328768f,
    0.0017791969003155828f,
    0.00046482900506816804f,
    -0.0005942207062616944f,
    -0.001274211797863245f,
    -0.0015658180927857757f
)

val CUT20k_FREQU441000_81 = floatArrayOf(
    -0.001173439435660839f,
    -0.0013220588443800807f,
    -0.0014174216194078326f,
    -0.0014371015131473541f,
    -0.001344241900369525f,
    -0.0010926731629297137f,
    -0.0006359109538607299f,
    6.102662155171856e-05f,
    0.0010086613474413753f,
    0.002181038958951831f,
    0.003506892127916217f,
    0.004866052884608507f,
    0.006092708557844162f,
    0.006986352615058422f,
    0.007330329157412052f,
    0.006916825193911791f,
    0.005576161667704582f,
    0.0032074018381536007f,
    -0.0001932808809215203f,
    -0.00451020197942853f,
    -0.00949520617723465f,
    -0.01476694829761982f,
    -0.01982414722442627f,
    -0.024073153734207153f,
    -0.026868684217333794f,
    -0.027565043419599533f,
    -0.02557377889752388f,
    -0.020422736182808876f,
    -0.011810937896370888f,
    0.00034637565840967f,
    0.015887508168816566f,
    0.0343928262591362f,
    0.05519434064626694f,
    0.07740680873394012f,
    0.09997876733541489f,
    0.12175998836755753f,
    0.1415802240371704f,
    0.15833275020122528f,
    0.17105573415756226f,
    0.17900437116622925f,
    0.18170763552188873f,
    0.17900437116622925f,
    0.17105573415756226f,
    0.15833275020122528f,
    0.1415802240371704f,
    0.12175998836755753f,
    0.09997876733541489f,
    0.07740680873394012f,
    0.05519434064626694f,
    0.0343928262591362f,
    0.015887508168816566f,
    0.00034637565840967f,
    -0.011810937896370888f,
    -0.020422736182808876f,
    -0.02557377889752388f,
    -0.027565043419599533f,
    -0.026868684217333794f,
    -0.024073153734207153f,
    -0.01982414722442627f,
    -0.01476694829761982f,
    -0.00949520617723465f,
    -0.00451020197942853f,
    -0.0001932808809215203f,
    0.0032074018381536007f,
    0.005576161667704582f,
    0.006916825193911791f,
    0.007330329157412052f,
    0.006986352615058422f,
    0.006092708557844162f,
    0.004866052884608507f,
    0.003506892127916217f,
    0.002181038958951831f,
    0.0010086613474413753f,
    6.102662155171856e-05f,
    -0.0006359109538607299f,
    -0.0010926731629297137f,
    -0.001344241900369525f,
    -0.0014371015131473541f,
    -0.0014174216194078326f,
    -0.0013220588443800807f,
    -0.001173439435660839f
)

val CUT150K_FREQ882000_33 = floatArrayOf(
    -0.003134171012789011f,
    -0.0011894033523276448f,
    0.003561273915693164f,
    0.007490499876439571f,
    0.0028927712701261044f,
    -0.011960101313889027f,
    -0.022091418504714966f,
    -0.006094967946410179f,
    0.033052872866392136f,
    0.05337196961045265f,
    0.009725987911224365f,
    -0.0819113552570343f,
    -0.1248428151011467f,
    -0.012555909343063831f,
    0.2594919204711914f,
    0.5536822080612183f,
    0.6810212731361389f,
    0.5536822080612183f,
    0.2594919204711914f,
    -0.012555909343063831f,
    -0.1248428151011467f,
    -0.0819113552570343f,
    0.009725987911224365f,
    0.05337196961045265f,
    0.033052872866392136f,
    -0.006094967946410179f,
    -0.022091418504714966f,
    -0.011960101313889027f,
    0.0028927712701261044f,
    0.007490499876439571f,
    0.003561273915693164f,
    -0.0011894033523276448f,
    -0.003134171012789011f
)

val CUT100k_FREQ882000_81 = floatArrayOf(
    -0.0002785049146041274f,
    0.0006263981922529638f,
    0.0013377333525568247f,
    0.0014987718313932419f,
    0.0008883375558070838f,
    -0.0004139418597333133f,
    -0.0019238163949921727f,
    -0.002842912683263421f,
    -0.002403649967163801f,
    -0.0003607268736232072f,
    0.0026430257130414248f,
    0.005138729698956013f,
    0.005447349976748228f,
    0.0026476318016648293f,
    -0.0026061797980219126f,
    -0.007982074283063412f,
    -0.010365035384893417f,
    -0.0074886176735162735f,
    0.000481632276205346f,
    0.010375704616308212f,
    0.01705990359187126f,
    0.0158873051404953f,
    0.005482250824570656f,
    -0.010659066028892994f,
    -0.024937506765127182f,
    -0.028901034966111183f,
    -0.017730645835399628f,
    0.006224516313523054f,
    0.03298535197973251f,
    0.04846572130918503f,
    0.04098278284072876f,
    0.008037149906158447f,
    -0.039974190294742584f,
    -0.08149675279855728f,
    -0.09113593399524689f,
    -0.05006295442581177f,
    0.04473206400871277f,
    0.17654871940612793f,
    0.3126954138278961f,
    0.4149402678012848f,
    0.4528735876083374f,
    0.4149402678012848f,
    0.3126954138278961f,
    0.17654871940612793f,
    0.04473206400871277f,
    -0.05006295442581177f,
    -0.09113593399524689f,
    -0.08149675279855728f,
    -0.039974190294742584f,
    0.008037149906158447f,
    0.04098278284072876f,
    0.04846572130918503f,
    0.03298535197973251f,
    0.006224516313523054f,
    -0.017730645835399628f,
    -0.028901034966111183f,
    -0.024937506765127182f,
    -0.010659066028892994f,
    0.005482250824570656f,
    0.0158873051404953f,
    0.01705990359187126f,
    0.010375704616308212f,
    0.000481632276205346f,
    -0.0074886176735162735f,
    -0.010365035384893417f,
    -0.007982074283063412f,
    -0.0026061797980219126f,
    0.0026476318016648293f,
    0.005447349976748228f,
    0.005138729698956013f,
    0.0026430257130414248f,
    -0.0003607268736232072f,
    -0.002403649967163801f,
    -0.002842912683263421f,
    -0.0019238163949921727f,
    -0.0004139418597333133f,
    0.0008883375558070838f,
    0.0014987718313932419f,
    0.0013377333525568247f,
    0.0006263981922529638f,
    -0.0002785049146041274f
)

class FIRFilter(
    private val input: Iterator<FloatArray>,
    private val coefs: FloatArray,
    private val decimation: Int = 1
) :
    Iterator<FloatArray> {
    private val length: Int = coefs.size
    private val delayLine = FloatArray(length)
    private var count = 0

    override fun next(): FloatArray {
        val nextArray = input.next()
        var result = FloatArray(ceil(nextArray.size.toFloat() / decimation).toInt())
        var resultCounter = 0
        nextArray.forEachIndexed { arrayIndex, value ->
            run {
                delayLine[count] = value
                if(arrayIndex.rem(decimation) == 0) {
                    var index = count
                    for (i in 0 until length) {
//                    result[arrayIndex] += coefs[i] * delayLine[index--]
                        result[resultCounter] += coefs[i] * delayLine[index--]
                        if (index < 0) index = length - 1
                    }
                    resultCounter++
                }
                if (++count >= length) count = 0
            }
        }
        return result
    }

    override fun hasNext() = input.hasNext()
}

class ComplexFIRFilter(
    private val input: Iterator<FloatArray>,
    private val coefs: FloatArray,
    private val decimation: Int = 1
) : Iterator<FloatArray> {
    private val length: Int = coefs.size
    private val reDelayLine = FloatArray(length)
    private val imDelayLine = FloatArray(length)
    private var count = 0


    override fun next(): FloatArray {
        val nextArray = input.next()
        val result = FloatArray(ceil(nextArray.size.toFloat() / decimation).toInt())
        val iterator = nextArray.iterator()
        var iteratorCounter = 0
        var resultCounter = 0
        println("result: ${result.size}, next: ${nextArray.size}, decimation: $decimation")
        while (iterator.hasNext()) {
            reDelayLine[count] = iterator.next()
            imDelayLine[count] = if (iterator.hasNext()) iterator.next() else break
            if (iteratorCounter.rem(decimation) == 0) {
                var index = count
                for (i in 0 until length) {
                    result[resultCounter] += coefs[i] * reDelayLine[index] / length
                    result[resultCounter+1] += coefs[i] * imDelayLine[index] / length
                    index--
                    if (index < 0) index = length - 1
                }
                resultCounter += 2
            }
            if (++count >= length) count = 0
            iteratorCounter += 2
        }
        return result
    }

    override fun hasNext() = input.hasNext()
}
